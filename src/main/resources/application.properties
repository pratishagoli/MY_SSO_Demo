# PostgreSQL Database Configuration
# Use environment variables for Render deployment
spring.datasource.url=${JDBC_DATABASE_URL}

# IMPORTANT: Since JDBC_DATABASE_URL includes credentials (postgresql://user:pass@...),
# we often do not need to repeat these, or we can use the environment variables if provided.
# If your application fails with the defaults below, remove these two lines entirely.
# For now, we will leave the safe defaults for local development.
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:pratisha}

# PostgreSQL Driver
spring.datasource.driver-class-name=org.postgresql.Driver

# --- FIX FOR DIALECT ERROR ---
# Explicitly set the Hibernate Dialect, as the application is failing to determine it
# during startup (Error: Unable to determine Dialect without JDBC metadata).
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
# -----------------------------

# Connection Pool Settings (helps with Render's connection limits)
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000

# IMPORTANT: This will automatically update your schema to match entity definitions
spring.jpa.hibernate.ddl-auto=update

# Enable SQL logging
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Spring Security and Transaction logging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.transaction=DEBUG
logging.level.org.springframework.orm.jpa=DEBUG

# Your custom service logging
logging.level.com.example.ssoapp.service.CustomOAuth2UserService=INFO
logging.level.com.example.ssoapp.service.AuthService=INFO
logging.level.com.example.ssoapp.security.jwt=INFO
logging.level.com.example.ssoapp.security.saml=DEBUG
logging.level.org.springframework.security.saml2=DEBUG
logging.level.org.springframework.security.saml2.provider.service=DEBUG
logging.level.org.springframework.security.saml2.provider.service.authentication=DEBUG
logging.level.org.springframework.security.saml2.provider.service.web=DEBUG
logging.level.org.springframework.security.web=DEBUG

# MiniOrange OIDC Configuration
spring.security.oauth2.client.registration.miniorange.client-id=NeXKWs6a9g0lywwLQAoBPwntbNV91HdT
spring.security.oauth2.client.registration.miniorange.client-secret=rbHqjgFowkLiOvKnURJV4LEUSEFlzWNj
spring.security.oauth2.client.registration.miniorange.scope=openid,profile,email
spring.security.oauth2.client.registration.miniorange.client-name=MiniOrange
spring.security.oauth2.client.registration.miniorange.provider=miniorange
spring.security.oauth2.client.registration.miniorange.authorization-grant-type=authorization_code
spring.security.oauth2.client.provider.miniorange.issuer-uri=https://pratisha.xecurify.com/moas/discovery/v2.0/NeXKWs6a9g0lywwLQAoBPwntbNV91HdT

# MiniOrange JWT Configuration (for manual JWT validation)
app.jwt.miniorange.issuer=4rIAZPjSTgKGuylgQvCNenKqZRkHOC6f
app.jwt.miniorange.certificate=-----BEGIN CERTIFICATE-----\
MIID/zCCAuegAwIBAgIJAPmPOnjOfbO/MA0GCSqGSIb3DQEBCwUAMIGVMQswCQYD\
VQQGEwJJTjEUMBIGA1UECAwLTUFIQVJBU0hUUkExDTALBgNVBAcMBFBVTkUxEzAR\
BgNVBAoMCk1JTklPUkFOR0UxEzARBgNVBAsMCk1JTklPUkFOR0UxEzARBgNVBAMM\
Ck1JTklPUkFOR0UxIjAgBgkqhkiG9w0BCQEWE2luZm9AbWluaW9yYW5nZS5jb20w\
HhcNMTYwMTMwMDgyMzE0WhcNMjYwMTI3MDgyMzE0WjCBlTELMAkGA1UEBhMCSU4x\
FDASBgNVBAgMC01BSEFSQVNIVFJBMQ0wCwYDVQQHDARQVU5FMRMwEQYDVQQKDApN\
SU5JT1JBTkdFMRMwEQYDVQQLDApNSU5JT1JBTkdFMRMwEQYDVQQDDApNSU5JT1JB\
TkdFMSIwIAYJKoZIhvcNAQkBFhNpbmZvQG1pbmlvcmFuZ2UuY29tMIIBIjANBgkq\
hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsSKksJcuQbZm/cw67JJkHvlzrzd3+aPL\
hfqy/FCKj/BmZ7mBZf0s3+89O0rOamsZP1NKzOE29ZL6ONLJHxU48LUbGciZupm/\
wf7dY/Av34uDcZ61ufKz0u17UTxgjLULIWBy//68EOr4Xbm/4bqhmKcB3CclMaom\
0LWeCrqittiLqunVCjFIbxXMT010WiBBnFwqjUqfuMnVLL+HrPPqgPqNhiKDdxBx\nHk9GDPq2+GEruM1jw7TUjVa+zbhekvdNTbj2Fo2sqf+mIkFLSaS6cHg0UeL7sX0w\nvQFDMwx+hpfRLMcYpFAmRMn3dI2zUnPgwvWeKHrnNOjHVkRTV4hgZQIDAQABo1Aw\nTjAdBgNVHQ4EFgQU85bt1wVl/f2LftBu1jeO499VUbYwHwYDVR0jBBgwFoAU85bt\n1wVl/f2LftBu1jeO499VUbYwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOC\nAQEApenCY36LGThXLAIRIvDQ6XnHELL7Wm53m3tHy+GA2MxUbcTqQC3tgXM+yC18\nEstjRHgWdQMtOcq9ohb5/TqWPoYAYnbg1SG9jEHJ3LLaIMI0idYo+zfPCtwliHLn\nsuZXH6ZU3mh/IQEBqINini6R/cSh9BpIjqwXKpjWoegl9XLI/RQ7Bbbya89TUBwm\n5KR3deWXdMZEj/d7hV8XdSWyi2CvWTeHIfkZVhcHg1ues9+Mt3kaBr4Z5/NkQPAN\njfMdKjZ8tfNTN7PgYAYyRW6C8aXcw+w0zIoGrcO2gVM9/3oR4gHm5MUHOMdAyONk\ng59+T+7NDlN7y4YmVIZQBgHByA==\
-----END CERTIFICATE-----

# In application.properties
spring.main.allow-bean-definition-overriding=true

# Server port (Render will override this with PORT env variable)
server.port=${PORT:8080}